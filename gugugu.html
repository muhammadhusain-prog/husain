<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Job Analysis Generator - MSDM</title>
    <!-- Memuat Tailwind CSS untuk styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat library Marked.js untuk mengubah Markdown ke HTML -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Memuat Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style tambahan untuk output yang dihasilkan agar lebih rapi */
        #output-container h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: #1e3a8a; /* Biru tua */
        }
        #output-container ul {
            list-style-position: inside;
            padding-left: 0.5rem;
        }
        #output-container p {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <!-- Header Aplikasi -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-800">ðŸš€ AI Job Analysis Generator</h1>
            <p class="text-md text-slate-600 mt-2">Ketik nama jabatan untuk membuat Uraian & Spesifikasi Jabatan secara otomatis.</p>
        </header>

        <!-- Konten Utama -->
        <main class="bg-white p-6 sm:p-8 rounded-xl shadow-lg">
            
            <!-- Area Input -->
            <div class="flex flex-col sm:flex-row gap-4 items-center">
                <input type="text" id="job-title-input" class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg" placeholder="Contoh: Social Media Specialist" required>
                <button id="generate-btn" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300 whitespace-nowrap">
                    Buat Analisis
                </button>
            </div>

            <!-- Area Output -->
            <div class="mt-8 border-t border-gray-200 pt-6">
                <!-- Status Placeholder Awal -->
                <div id="placeholder" class="text-center text-gray-500 py-10">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <p class="mt-4 text-base">Hasil analisis jabatan akan muncul di sini.</p>
                </div>
                
                <!-- Indikator Loading -->
                <div id="loading" class="text-center text-gray-500 py-10 hidden">
                    <svg class="animate-spin mx-auto h-10 w-10 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-4 text-base">AI sedang menganalisis... Mohon tunggu sebentar.</p>
                </div>

                <!-- Kontainer Hasil -->
                <div id="output-container" class="prose max-w-none prose-slate">
                    <!-- Konten dari AI akan ditampilkan di sini -->
                </div>
            </div>

        </main>
        
        <!-- Footer -->
        <footer class="text-center mt-10 py-4 border-t border-gray-200">
            <p class="text-sm text-gray-500">Didukung oleh teknologi Generative AI.</p>
        </footer>
    </div>

    <script>
        const jobTitleInput = document.getElementById('job-title-input');
        const generateBtn = document.getElementById('generate-btn');
        const placeholder = document.getElementById('placeholder');
        const loading = document.getElementById('loading');
        const outputContainer = document.getElementById('output-container');

        // Tambahkan event listener untuk tombol Enter di input field
        jobTitleInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Mencegah form submit (jika ada)
                generateBtn.click();
            }
        });

        generateBtn.addEventListener('click', generateAnalysis);

        async function generateAnalysis() {
            const jobTitle = jobTitleInput.value.trim();
            if (!jobTitle) {
                alert('Mohon masukkan nama jabatan terlebih dahulu.');
                return;
            }

            // Atur UI state ke mode loading
            placeholder.classList.add('hidden');
            outputContainer.innerHTML = '';
            loading.classList.remove('hidden');
            generateBtn.disabled = true;
            generateBtn.innerText = 'Memproses...';


            // Konfigurasi untuk panggilan ke Gemini API
            const apiKey = "AIzaSyAzyey8Gbi_XxtibcJXPeQ4DfTqdL1nolw"; // API Key akan di-inject oleh environment, biarkan kosong.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const systemPrompt = `Anda adalah seorang ahli rekrutmen dan spesialis SDM (Sumber Daya Manusia) yang sangat berpengalaman di Indonesia. Tugas Anda adalah membuat analisis jabatan yang detail, profesional, dan relevan dengan konteks pasar kerja di Indonesia.`;
            
            const userQuery = `
                Buatkan Analisis Jabatan yang lengkap untuk posisi: "${jobTitle}".

                Analisis harus mencakup dua bagian utama:
                1.  **Uraian Jabatan (Job Description)**
                2.  **Spesifikasi Jabatan (Job Specification)**

                Detail untuk setiap bagian:
                - **Uraian Jabatan**:
                  - **Ringkasan Jabatan**: Jelaskan peran dan tujuan utama posisi ini dalam 1-2 kalimat.
                  - **Tugas & Tanggung Jawab Utama**: Buat daftar (bullet points) tugas-tugas kunci yang dilakukan dalam peran ini.

                - **Spesifikasi Jabatan**:
                  - **Pendidikan & Kualifikasi**: Sebutkan tingkat pendidikan minimum dan bidang studi yang relevan.
                  - **Pengalaman**: Sebutkan jumlah tahun pengalaman kerja yang dibutuhkan dan jenis pengalamannya.
                  - **Keahlian (Skills)**: Buat dua sub-bagian untuk Hard Skills (kemampuan teknis) dan Soft Skills (kemampuan interpersonal), masing-masing dalam bentuk bullet points.

                Gunakan format Markdown dengan heading, bold, dan bullet points agar hasilnya rapi dan mudah dibaca.
            `;

            const payload = {
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
                contents: [{
                    parts: [{ text: userQuery }]
                }],
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

                if (text) {
                    // Menggunakan Marked.js untuk mengonversi Markdown ke HTML
                    outputContainer.innerHTML = marked.parse(text);
                } else {
                    outputContainer.innerHTML = '<p class="text-red-500 text-center">Maaf, terjadi kesalahan saat menghasilkan konten. Respon dari AI kosong.</p>';
                }

            } catch (error) {
                console.error('Error:', error);
                outputContainer.innerHTML = `<p class="text-red-500 text-center">Gagal terhubung ke layanan AI. Silakan coba lagi nanti. <br><small>${error.message}</small></p>`;
            } finally {
                // Kembalikan UI state ke normal
                loading.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.innerText = 'Buat Analisis';
            }
        }
    </script>

</body>
</html>
